{"version":3,"file":"password_strength.min.js","mappings":"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","sources":["webpack://login/webpack/bootstrap","webpack://login/webpack/runtime/define property getters","webpack://login/webpack/runtime/hasOwnProperty shorthand","webpack://login/webpack/runtime/make namespace object","webpack://login/./partials/shared.js","webpack://login/./partials/qr_login.js","webpack://login/./partials/webauth.js","webpack://login/./login.js","webpack://login/./password_strength.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export function closeMobileMenu(){\r\n\t//close mobile menu\r\n\tdocument.querySelectorAll('#site-navigation, #mobile-menu-control-wrapper').forEach(el=>el.classList.remove('toggled'));\r\n\tdocument.querySelector('body').classList.remove('mobile-menu-open');\r\n\tdocument.querySelectorAll(\"#mobile-menu-control-wrapper > button\").forEach(el=>el.ariaExpanded = 'false');\r\n}\r\n\r\n// Decodes a Base64Url string\r\nconst base64UrlDecode = (input) => {\r\ninput = input\r\n\t.replace(/-/g, '+')\r\n\t.replace(/_/g, '/');\r\n\r\nconst pad = input.length % 4;\r\nif (pad) {\r\n\tif (pad === 1) {\r\n\tthrow new Error('InvalidLengthError: Input base64url string is the wrong length to determine padding');\r\n\t}\r\n\tinput += new Array(5-pad).join('=');\r\n}\r\n\r\nreturn window.atob(input);\r\n};\r\n\r\n// Converts an array of bytes into a Base64Url string\r\nconst arrayToBase64String = (a) => btoa(String.fromCharCode(...a));\r\n\r\n// Prepares the public key options object returned by the Webauthn Framework\r\nexport const preparePublicKeyOptions = publicKey => {\r\n\t//Convert challenge from Base64Url string to Uint8Array\r\n\tpublicKey.challenge = Uint8Array.from(\r\n\t\tbase64UrlDecode(publicKey.challenge),\r\n\t\tc => c.charCodeAt(0)\r\n\t);\r\n\r\n\t//Convert the user ID from Base64 string to Uint8Array\r\n\tif (publicKey.user !== undefined) {\r\n\t\tpublicKey.user = {\r\n\t\t...publicKey.user,\r\n\t\tid: Uint8Array.from(\r\n\t\t\twindow.atob(publicKey.user.id),\r\n\t\t\tc => c.charCodeAt(0)\r\n\t\t),\r\n\t\t};\r\n\t}\r\n\r\n\t//If excludeCredentials is defined, we convert all IDs to Uint8Array\r\n\tif (publicKey.excludeCredentials !== undefined) {\r\n\t\tpublicKey.excludeCredentials = publicKey.excludeCredentials.map(\r\n\t\t\tdata => {\r\n\t\t\treturn {\r\n\t\t\t\t...data,\r\n\t\t\t\tid: Uint8Array.from(\r\n\t\t\t\t\tbase64UrlDecode(data.id),\r\n\t\t\t\t\tc => c.charCodeAt(0)\r\n\t\t\t\t),\r\n\t\t\t};\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tif (publicKey.allowCredentials !== undefined) {\r\n\t\tpublicKey.allowCredentials = publicKey.allowCredentials.map(\r\n\t\t\tdata => {\r\n\t\t\treturn {\r\n\t\t\t\t...data,\r\n\t\t\t\tid: Uint8Array.from(\r\n\t\t\t\t\tbase64UrlDecode(data.id),\r\n\t\t\t\t\tc => c.charCodeAt(0)\r\n\t\t\t\t),\r\n\t\t\t};\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\treturn publicKey;\r\n};\r\n\r\n// Prepares the public key credentials object returned by the authenticator\r\nexport const preparePublicKeyCredentials = data => {\r\n\tconst publicKeyCredential = {\r\n\t\tid: data.id,\r\n\t\ttype: data.type,\r\n\t\trawId: arrayToBase64String(new Uint8Array(data.rawId)),\r\n\t\tresponse: {\r\n\t\tclientDataJSON: arrayToBase64String(\r\n\t\t\tnew Uint8Array(data.response.clientDataJSON)\r\n\t\t),\r\n\t\t},\r\n\t};\r\n\r\n\tif (data.response.attestationObject !== undefined) {\r\n\t\tpublicKeyCredential.response.attestationObject = arrayToBase64String(\r\n\t\t\tnew Uint8Array(data.response.attestationObject)\r\n\t\t);\r\n\t}\r\n\r\n\tif (data.response.authenticatorData !== undefined) {\r\n\t\tpublicKeyCredential.response.authenticatorData = arrayToBase64String(\r\n\t\t\tnew Uint8Array(data.response.authenticatorData)\r\n\t\t);\r\n\t}\r\n\r\n\tif (data.response.signature !== undefined) {\r\n\t\tpublicKeyCredential.response.signature = arrayToBase64String(\r\n\t\t\tnew Uint8Array(data.response.signature)\r\n\t\t);\r\n\t}\r\n\r\n\tif (data.response.userHandle !== undefined) {\r\n\t\tpublicKeyCredential.response.userHandle = arrayToBase64String(\r\n\t\t\tnew Uint8Array(data.response.userHandle)\r\n\t\t);\r\n\t}\r\n\r\n\treturn publicKeyCredential;\r\n};\r\n\r\nexport function showMessage(message){\r\n\tdocument.querySelector(\"#message\").innerHTML= DOMPurify.sanitize(message);\r\n}\r\n\r\n//show loader\r\nexport async function requestLogin(){\r\n\t//hide everything\r\n\tdocument.querySelectorAll('.authenticator_wrapper:not(.hidden)').forEach(el=>{\r\n\t\tel.classList.add('hidden');\r\n\t\tel.classList.add('current-method');\r\n\t});\r\n\t\r\n\t//show login message\r\n\tdocument.getElementById('logging_in_wrapper').classList.remove('hidden');\r\n\r\n\tlet form \t\t= document.getElementById('loginform');\r\n\tlet formData\t= new FormData(form);\r\n\tform.querySelectorAll('.hidden [required]').forEach(el=>{el.required = false});\r\n\tlet validity\t= form.reportValidity();\r\n\t//if not valid return\r\n\tif(!validity){\r\n\t\treturn false;\r\n\t}\r\n\r\n\tawait Main.waitForInternet();\r\n\r\n\tlet response\t= await FormSubmit.fetchRestApi('login/request_login', formData);\r\n\r\n\tif(response){\r\n\t\tconsole.log(response);\r\n\t\t// We are logging in from an iframe\r\n\t\tif(window.self !== window.top){\r\n\r\n\t\t\t// change message\r\n\t\t\tconsole.log(window.parent.document.getElementById('iframe-loader'));\r\n\t\t\tconsole.log(window.parent.document);\r\n\t\t\tconsole.log(window.parent);\r\n\t\t\twindow.parent.document.getElementById('iframe-loader').textContent\t= 'Succesfully logged in, you may now close this popup';\r\n\r\n\t\t\t// Refresh the rest api nonce\r\n\t\t\twindow.parent.sim.restNonce\t= response.nonce;\r\n\r\n\t\t\t// Update user id\r\n\t\t\twindow.parent.sim.userId\t= response.id;\r\n\r\n\t\t\tconsole.log(window.parent.document.getElementById('iframe-loader'));\r\n\r\n\t\t\t// close all iframes\r\n\t\t\twindow.parent.document.querySelectorAll('iframe').forEach(el=>el.remove());\r\n\t\t}else{\r\n\t\t\tdocument.querySelector('#logging_in_wrapper .status_message').textContent='Succesfully logged in, redirecting...';\r\n\r\n\t\t\tif(response.redirect == ''){\r\n\t\t\t\t// refresh the page\r\n\t\t\t\tlocation.reload();\r\n\t\t\t}else{\r\n\t\t\t\t// go to the redirect page\r\n\t\t\t\tlocation.href = response.redirect;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}else{\r\n\t\tdocument.getElementById('logging_in_wrapper').classList.add('hidden');\r\n\r\n\t\tdocument.querySelector('.current-method').classList.remove('hidden');\r\n\r\n\t\treturn false;\r\n\t}\r\n}","import {\r\n\tshowMessage\r\n} from './shared.js';\r\n\r\nlet intervalId;\r\nlet checkCount\t\t\t= 5;\r\n\r\n// Show qr code and start polling for login info\r\nexport function showLoginQrCode(){\r\n\tdocument.getElementById('usercred_wrapper').classList.add('hidden');\r\n\r\n\tshowMessage('Fetching QR code...');\r\n\r\n\tMain.showLoader(document.getElementById(`qrcode-wrapper`).firstChild);\r\n\r\n\t// get the QR code\r\n\trefreshQrCode();\r\n\t\r\n\t // Check for login permission every 5 seconds\r\n\tintervalId\t= setInterval(refreshQrCode, 5000);\r\n}\r\n\r\nfunction login(response){\r\n\tclearInterval(intervalId);\r\n\r\n\tshowMessage('Succesfully logged in, redirecting...');\r\n\r\n\tMain.showLoader(document.getElementById(`qrcode-wrapper`));\r\n\r\n\tif(!response.startsWith('http')){\r\n\t\tlocation.reload();\r\n\t}else{\r\n\t\tlocation.href = response;\r\n\t}\r\n}\r\n\r\nasync function refreshQrCode(){\r\n\tcheckCount++;\r\n\r\n    let formData    = new FormData();\r\n\tlet wrapper\t\t= document.getElementById(`qrcode-wrapper`);\r\n\tlet qrCodeImage = document.getElementById('login-qr-code');\r\n\r\n\t// refresh the qr code after 30 seconds\r\n\tif(checkCount == 6){\r\n\t\tconsole.log('Refreshing QR code');\r\n\r\n        checkCount      = 0;\r\n\r\n\t\t// also check if previous qr code has been scanned\r\n\t\tif(qrCodeImage != null){\r\n\t\t\tformData.append('token', qrCodeImage.dataset.token);\r\n\t\t\tformData.append('key', qrCodeImage.dataset.key);\r\n\t\t}\r\n\t\t\r\n\t\t// Use AJAX to get the qr code\r\n\t\tlet response    = await FormSubmit.fetchRestApi('login/get_login_qr_code', formData);\r\n\r\n\t\tif(response){\r\n\t\t\twrapper.innerHTML=response;\r\n\r\n\t\t\tshowMessage('Scan the QR code to login');\r\n\r\n\t\t\tconsole.log(`New token: ${document.getElementById('login-qr-code').dataset.token}`);\r\n\t\t\tconsole.log(`New key: ${document.getElementById('login-qr-code').dataset.key}`);\r\n\t\t}else{\r\n\t\t\twrapperinnerHTML='';\r\n\r\n\t\t\tshowMessage('QR Code Refresh Failed');\r\n\t\t}\r\n\t}else{\r\n\t\tconsole.log('Checking for login permission');\r\n\t\t\r\n        if(qrCodeImage == null){\r\n            return;\r\n        }\r\n\r\n\t\t// Use AJAX to check if the code has been scanned\r\n        formData.append('token', qrCodeImage.dataset.token);\r\n        formData.append('key', qrCodeImage.dataset.key);\r\n        formData.append('old-token', qrCodeImage.dataset.oldtoken);\r\n\t\tlet response\t= await FormSubmit.fetchRestApi('login/qr_code_scanned', formData);\r\n\r\n\t\tif(response){\r\n\t\t\tlogin(response);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport function hideQrCode(){\r\n\tclearInterval(intervalId);\r\n\r\n\tshowMessage('');\r\n\r\n\tdocument.getElementById('usercred_wrapper').classList.remove('hidden');\r\n\r\n\tdocument.getElementById(`qrcode-wrapper`).innerHTML = '';\r\n}","import {\r\n    preparePublicKeyCredentials,\r\n    preparePublicKeyOptions,\r\n\tshowMessage,\r\n\trequestLogin\r\n} from './shared.js';\r\n\r\nlet credParsing\t\t\t        = false;\r\nlet abortController;\r\nexport let webauthnSupported\t= false;\r\n\r\nwindow.PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable().then(\r\n\tresult => {\r\n\t  if (!result) {\r\n\t\tconsole.log(\"No platform authenticator found. If your OS does not come with one, try using devtools to set one up.\");\r\n\t  }\r\n\t}\r\n);\r\n\r\n/**\r\n * \r\n * @param {string} username The user name to authenticate\r\n * @param {*} messageEl the html onject to display messages in\r\n */\r\nexport async function webAuthVerification(username, messageEl){\r\n\tmessageEl.classList.remove('success');\r\n\tmessageEl.classList.remove('error');\r\n\ttry{\r\n\t\t// Get the challenge\r\n\t\tlet formData\t\t\t= new FormData();\r\n\t\tformData.append('username', username);\r\n\r\n\t\tlet response\t\t\t= await FormSubmit.fetchRestApi('login/auth_start', formData);\r\n\t\tif(!response){\r\n\t\t\tthrow new Error('Fetching Server Challenge failed');\r\n\t\t}\r\n\r\n\t\tlet publicKey\t\t\t= preparePublicKeyOptions(response);\r\n\r\n\t\t// Update message\r\n\t\tif(messageEl != null){\r\n\t\t\tmessageEl.textContent\t= 'Waiting for biometric';\r\n\t\t}\r\n\r\n\t\t// Verify on device\r\n\t\tlet credentials\t\t\t= await navigator.credentials.get({\tpublicKey });\r\n\r\n\t\t// Update message\r\n\t\tif(messageEl != null){\r\n\t\t\tmessageEl.textContent\t= 'Verifying...';\r\n\t\t}\r\n\r\n\t\t// Verify on the server\r\n\t\tconst publicKeyCredential \t= preparePublicKeyCredentials(credentials);\r\n\t\tformData\t\t\t\t\t= new FormData();\r\n\t\tformData.append('publicKeyCredential', JSON.stringify(publicKeyCredential));\r\n\t\tresponse\t\t\t\t\t= await FormSubmit.fetchRestApi('login/auth_finish', formData);\r\n\t\tif(!response){\r\n\t\t\tthrow new Error('Verification failed');\r\n\t\t}\r\n\r\n\t\tif(messageEl != null){\r\n\t\t\tmessageEl.textContent\t= 'Verification successfull';\r\n\t\t\tmessageEl.classList.add('success');\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}catch(error){\r\n\t\tif(messageEl != null){\r\n\t\t\tmessageEl.textContent\t= error;\r\n\t\t\tmessageEl.classList.add('error');\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\n// Send request to start webauthn\r\nexport async function verifyWebauthn(methods){\t\r\n\t//show webauthn messages\r\n\tdocument.getElementById('webauthn_wrapper').classList.remove('hidden');\r\n\r\n\tlet username\t= document.getElementById('username').value;\r\n\r\n\ttry{\r\n\t\tlet result\t= await webAuthVerification(username, document.querySelector('#webauthn_wrapper .status_message'));\r\n\r\n\t\tif(!result){\r\n\t\t\tthrow new Error( 'Webauthentication failed' );\r\n\t\t}\r\n\r\n\t\t//authentication success\r\n\t\tawait requestLogin();\r\n\t}catch (error){\r\n\t\tif(document.getElementById('logging_in_wrapper').classList.add('hidden'));\r\n\r\n\t\t//authentication failed\r\n\t\tdocument.querySelector('#webauthn_wrapper').classList.add('hidden');\r\n\r\n\t\tif(methods.length == 1){\r\n\t\t\tshowMessage('Authentication failed, please setup an additional login factor.');\r\n\t\t\trequestLogin();\r\n\t\t}else{\r\n\t\t\tvar message;\r\n\t\t\tif(error['message'] == \"No authenticator available\"){\r\n\t\t\t\tmessage = \"No biometric login for this device found. <br>Give verification code.\";\r\n\t\t\t}else{\r\n\t\t\t\tmessage = 'Web authentication failed, please give verification code.';\r\n\t\t\t\tmessage += '<button type=\"button\" class=\"button small\" id=\"retry_webauthn\" style=\"float:right;margin-top:-20px;\">Retry</button>';\r\n\t\t\t\tconsole.error('Authentication failure: '+error['message']);\r\n\t\t\t}\r\n\t\t\tshowMessage(message);\r\n\r\n\t\t\t//Show other 2fa fields\r\n\t\t\tshowTwoFaFields(methods);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// Request email code for 2fa login\r\nexport async function requestEmailCode(){\r\n\t//add new one\r\n\tvar loader\t\t\t\t= \"<img id='loader' src='\"+sim.loadingGif+\"' style='height:30px;margin-top:-6px;float:right;'>\";\r\n\tshowMessage(`Sending e-mail... ${loader}`);\r\n\r\n\tvar username\t= document.getElementById('username').value;\r\n\tvar formData\t= new FormData();\r\n\tformData.append('username',username);\r\n\r\n\tvar response\t= await FormSubmit.fetchRestApi('login/request_email_code', formData, false);\r\n\t\r\n\tif(response){\r\n\t\tshowMessage(response);\r\n\t}else{\r\n\t\tshowMessage(`Sending e-mail failed`);\r\n\t}\r\n}\r\n\r\nexport async function processCredential(credential){\r\n\tif(credParsing){\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (credential) {\r\n\t\tcredParsing\t= true;\r\n\t\tlet username = String.fromCodePoint(...new Uint8Array(credential.response.userHandle));\r\n\r\n\t\tdocument.querySelector('#webauthn_wrapper .status_message').textContent='Verifying credentials...';\r\n\r\n\t\t// Verify on the server\r\n\t\tconst publicKeyCredential \t= preparePublicKeyCredentials(credential);\r\n\t\tlet formData\t\t\t\t= new FormData();\r\n\t\tformData.append('publicKeyCredential', JSON.stringify(publicKeyCredential));\r\n\t\tlet response\t\t\t\t= await FormSubmit.fetchRestApi('login/auth_finish', formData, false);\r\n\r\n\t\tif(response){\r\n\t\t\tshowMessage('Passkey login succesfull');\r\n\t\t}else{\r\n\t\t\tdocument.querySelector('#webauthn_wrapper .status_message').textContent='Please authenticate';\r\n\r\n\t\t\tdocument.querySelectorAll('#usercred_wrapper').forEach(el=>el.classList.remove('hidden'));\r\n\t\t\tdocument.querySelectorAll('#webauthn_wrapper').forEach(el=>el.classList.add('hidden'));\r\n\r\n\t\t\tshowMessage('Passkey login failed, try using your username and password');\r\n\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t//authentication success\r\n\t\treturn await requestLogin();\r\n\r\n\t} else {\r\n\t\tconsole.log(\"Credential returned null\");\r\n\r\n\t\tdocument.getElementById('usercred_wrapper').classList.remove('hidden');\r\n\t\tdocument.getElementById('webauthn_wrapper').classList.add('hidden');\r\n\r\n\t\tshowMessage('Passkey login failed');\r\n\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nexport let startConditionalRequest = async (mediation) => {\r\n\tif (window.PublicKeyCredential && PublicKeyCredential.isConditionalMediationAvailable) {\r\n\t\tconsole.log(\"Conditional UI is understood by the browser\");\r\n\t\tif (!await window.PublicKeyCredential.isConditionalMediationAvailable()) {\r\n\t\t\tconsole.log(\"Conditional UI is understood by your browser but not available\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t} else {\r\n\t\tif (!navigator.credentials.conditionalMediationSupported) {\r\n\t\t\tconsole.log(\"Your browser does not implement Conditional UI (are you running the right chrome/safari version with the right flags?)\");\r\n\t\t\treturn;\r\n\t\t} else {\r\n\t\t\tconsole.log(\"This browser understand the old version of Conditional UI feature detection\");\r\n\t\t}\r\n\t}\r\n\r\n\tif(abortController != undefined){\r\n\t\tconsole.log('Cancelling previous request');\r\n\t\tabortController.abort('aborted');\r\n\t}\r\n\t\r\n\tabortController\t= new AbortController();\r\n\t\t\r\n\tabortController.onAbort\t= function(ev){\r\n\t\tconsole.log(ev);\r\n\t}\r\n\tabortController.signal.onAbort\t= function(ev){\r\n\t\tconsole.log(ev);\r\n\t}\r\n\r\n\tif(mediation != 'conditional'){\r\n\t\tdocument.getElementById('usercred_wrapper').classList.add('hidden');\r\n\t\tdocument.getElementById('webauthn_wrapper').classList.remove('hidden');\r\n\r\n\t\tshowMessage('Performing passkey login');\r\n\t}\r\n\r\n\tlet usercredWrapper\t= document.getElementById('usercred_wrapper');\r\n\r\n\ttry {\r\n\t\tlet formData\t\t\t= new FormData();\r\n\t\tformData.append('username', '');\r\n\r\n\t\tlet response\t\t\t= await FormSubmit.fetchRestApi('login/auth_start', formData);\r\n\t\tif(!response){\r\n\t\t\tthrow new Error('auth_start failed');\r\n\t\t}\r\n\r\n\t\tlet publicKey\t\t\t= preparePublicKeyOptions(response);\r\n\r\n\t\tlet credential = await navigator.credentials.get({\r\n\t\t\tsignal: abortController.signal,\r\n\t\t\tpublicKey: {\r\n\t\t\t\tchallenge: publicKey.challenge\r\n\t\t\t},\r\n\t\t\t//mediation: 'silent',\r\n\t\t\t//mediation: 'conditional',\r\n\t\t\t//mediation: 'required',\r\n\t\t\tmediation: mediation\r\n\t\t});\r\n\r\n\t\tif(mediation == 'conditional'){\t\r\n\t\t\tusercredWrapper.classList.add('hidden');\r\n\t\t\tdocument.getElementById('webauthn_wrapper').classList.remove('hidden');\r\n\t\r\n\t\t\tshowMessage('Performing passkey login');\r\n\t\t}\r\n\t\t\r\n\t\treturn await processCredential(credential);\r\n\t} catch (error) {\r\n\t\tif (error == \"aborted\") {\r\n\t\t\tconsole.log(\"request aborted\");\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif(error.message.includes('A request is already pending.')){\r\n\t\t\tstartConditionalRequest(mediation);\r\n\t\t}\r\n\r\n\t\t// only do when login modal is open\r\n\t\tif(usercredWrapper != null){\r\n\t\t\tusercredWrapper.classList.remove('hidden');\r\n\t\t\tdocument.getElementById('webauthn_wrapper').classList.add('hidden');\r\n\r\n\t\t\tshowMessage('Passkey login failed, try using your username and password');\r\n\t\t}\r\n\r\n\t\tconsole.log(error);\r\n\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nexport function checkWebauthnAvailable(){\r\n\tif (window.PublicKeyCredential) {\r\n\t\tPublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable().then((available) => {\r\n\t\t\tif (available) {\r\n\t\t\t\tconsole.log(\"Supported.\");\r\n\t\t\t\twebauthnSupported = true;\r\n\t\t\t} else {\r\n\t\t\t\tconsole.log(\"WebAuthn supported, Platform Authenticator not supported.\");\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch((err) => {\r\n\t\t\tconsole.error(\"Something went wrong.\");\r\n\t\t\tconsole.error(err);\r\n\t\t});\r\n\t} else {\r\n\t\tconsole.log(\"Not supported.\");\r\n\t}\r\n}\r\n\r\n// Display the form for the 2fa email or authenticator code\r\nexport function showTwoFaFields(methods){\r\n\tif(methods.includes('email')){\r\n\t\trequestEmailCode();\r\n\t}\r\n\r\n\t//show 2fa fields\r\n\tfor(const element of methods){\r\n\t\tif(element == 'webauthn'){\r\n\t\t\t//do not show webauthn\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tvar wrapper\t= document.getElementById(element+'_wrapper');\r\n\t\tif(wrapper != null){\r\n\t\t\twrapper.classList.remove('hidden');\r\n\t\t\twrapper.querySelectorAll('input').forEach(el=>window.setTimeout(() => el.focus(), 0));\r\n\t\t}\r\n\t}\r\n\r\n\t//enable login button\r\n\tdocument.querySelector(\"#login_button\").disabled\t\t\t= '';\r\n\t//show login button\r\n\tdocument.querySelector('#submit_login_wrapper').classList.remove('hidden');\r\n}","import {\r\n\tcloseMobileMenu,\r\n\tshowMessage,\r\n\trequestLogin\r\n} from './partials/shared.js';\r\n\r\nimport {\r\n\tshowLoginQrCode,\r\n\thideQrCode\r\n} from './partials/qr_login.js';\r\n\r\nimport {\r\n\tverifyWebauthn,\r\n\tstartConditionalRequest,\r\n\tcheckWebauthnAvailable,\r\n\tshowTwoFaFields,\r\n\twebauthnSupported\r\n} from './partials/webauth.js';\r\n\r\n//Add an event listener to the login or register button\r\nconsole.log(\"Login.js loaded\");\r\n\r\nlet modal;\r\n\r\n// Check if a valid username and password is submitted\r\nasync function verifyCreds(){\r\n\tvar username\t= document.getElementById('username').value;\r\n\tvar password\t= document.getElementById('password').value;\r\n\r\n\t// Check if the fields are filled\r\n\tif(username != '' && password != ''){\r\n\t\tdocument.querySelector('#usercred_wrapper .loadergif').classList.remove('hidden');\r\n\t}else{\r\n\t\tshowMessage('Please give an username and password!');\r\n\t\treturn;\r\n\t}\r\n\r\n\t// Make sure we have a internet connection\r\n\tawait Main.waitForInternet();\r\n\r\n\tvar formData\t= new FormData();\r\n\tformData.append('username',username);\r\n\tformData.append('password',password);\r\n\r\n\tvar response\t= await FormSubmit.fetchRestApi('login/check_cred', formData);\r\n\r\n \tif(response){\r\n\t\tif(response == 'false') {\r\n\t\t\tshowMessage('Invalid login, try again');\r\n\t\t\t\r\n\t\t\t// hide loader\r\n\t\t\tdocument.querySelector('#usercred_wrapper .loadergif').classList.add('hidden');\r\n\t\t} else {\r\n\t\t\taddMethods(response);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n//request password reset e-mail\r\nasync function resetPassword(form){\r\n\tvar username\t= document.getElementById('username').value;\r\n\r\n\tif(username == ''){\r\n\t\tMain.displayMessage('Specify your username first','error');\r\n\t\treturn;\r\n\t}\r\n\r\n\tlet button\t= form.querySelector('#lost_pwd_link');\r\n\t\r\n\tbutton.classList.add('hidden');\r\n\tlet loader = Main.showLoader(button, false, 'Sending e-mail...   ');\r\n\r\n\tlet formData\t= new FormData(form);\r\n\tformData.append('username', username);\r\n\t\r\n\tlet response\t= await FormSubmit.fetchRestApi('login/request_pwd_reset', formData);\r\n\r\n\tif (response) {\r\n\t\tMain.displayMessage(response,'success');\r\n\t}\r\n\r\n\tloader.remove();\r\n\tbutton.classList.remove('hidden');\r\n}\r\n\r\n// request a new user account\r\nasync function requestAccount(target){\r\n\tvar form \t\t= target.closest('form');\r\n\r\n\t// Show loader\r\n\tform.querySelector('.loadergif').classList.remove('hidden');\r\n\r\n\tvar formData\t= new FormData(form);\r\n\r\n\tvar response\t= await FormSubmit.fetchRestApi('login/request_user_account', formData);\r\n\t\r\n\tif(response){\r\n\t\tMain.displayMessage(response);\r\n\t}\r\n\r\n\t// reset form \r\n\tform.reset();\r\n\r\n\t// Hide loader\r\n\tform.querySelector('.loadergif').classList.add('hidden');\r\n}\r\n\r\nfunction addMethods(result){\r\n\tdocument.querySelector('#usercred_wrapper .loadergif').classList.add('hidden');\r\n\t\r\n\tif(typeof(result) == 'string' && result){\r\n\t\t//hide login form\r\n\t\tdocument.querySelectorAll(\"#usercred_wrapper\").forEach(el=>el.classList.add('hidden'));\r\n\r\n\t\tdocument.getElementById('logging_in_wrapper').classList.remove('hidden');\r\n\r\n\t\tif(location.href != result){\r\n\t\t\t//redirect to the returned webpage\r\n\t\t\tlocation.href\t= result;\r\n\t\t}else{\r\n\t\t\t//close login modal\r\n\t\t\tMain.hideModals();\r\n\t\t}\r\n\t}else if(!result){\r\n\t\t//incorrect creds add message, but only once\r\n\t\tshowMessage('Invalid username or password!');\r\n\t}else if(typeof(result) == 'object'){\r\n\t\t//hide cred fields\r\n\t\tdocument.querySelectorAll(\"#usercred_wrapper\").forEach(el=>el.classList.add('hidden'));\r\n\r\n\t\t//hide messsages\r\n\t\tshowMessage('');\r\n\r\n\t\tif(result.find(element => element == 'webauthn')){\r\n\t\t\tif(webauthnSupported){\r\n\t\t\t\t//correct creds and webauthn enabled\r\n\t\t\t\tverifyWebauthn(result);\r\n\t\t\t}else if(result.length == 1){\r\n\t\t\t\tshowMessage('You do not have a valid second login method for this device, please add one.');\r\n\t\t\t\trequestLogin();\r\n\t\t\t}else{\r\n\t\t\t\tshowTwoFaFields(result);\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\t//correct creds and 2fa enabled\r\n\t\t\tshowTwoFaFields(result);\r\n\t\t}\r\n\t}else{\r\n\t\t//something went wrong, reload the page\r\n\t\tlocation.reload();\r\n\t}\r\n}\r\n\r\ndocument.addEventListener('keypress', function (e) {\r\n    if (e.key === 'Enter' && document.querySelector(\"#usercred_wrapper\") != null){\r\n\t\tif(!document.querySelector(\"#usercred_wrapper\").classList.contains('hidden')) {\r\n\t\t\tverifyCreds();\r\n\t\t}else if(!document.querySelector(\"#submit_login_wrapper\").classList.contains('hidden')){\r\n\t\t\trequestLogin();\r\n\t\t}\r\n\t}\r\n});\r\n\r\nexport function togglePassworView(ev){\r\n\tvar target\t= ev.target;\r\n\r\n\tif(ev.target.tagName == 'IMG'){\r\n\t\ttarget\t= ev.target.parentNode;\r\n\t}\r\n\r\n\tif(target.dataset.toggle == '0'){\r\n\t\ttarget.title\t\t\t\t\t\t\t\t= 'Hide password';\r\n\t\ttarget.dataset.toggle\t\t\t\t\t\t= '1';\r\n\t\ttarget.innerHTML\t\t\t\t\t\t\t= target.innerHTML.replace('invisible', 'visible');\r\n\t\ttarget.closest('.password').querySelector('input[type=\"password\"]').type\t= 'text';\r\n\t}else{\r\n\t\ttarget.title\t\t\t\t\t\t\t\t= 'Show password';\r\n\t\ttarget.dataset.toggle\t\t\t\t\t\t= '0';\r\n\t\ttarget.innerHTML\t\t\t\t\t\t\t= target.innerHTML.replace('visible', 'invisible');\r\n\t\ttarget.closest('.password').querySelector('input[type=\"text\"]').type\t= 'password';\r\n\t}\r\n}\r\n\r\n// Show the modal with the login form\r\nfunction openLoginModal(){\r\n\t// Make sure the menu is closed\r\n\tcloseMobileMenu();\r\n\r\n\t//prevent page scrolling\r\n\tdocument.querySelector('body').style.overflowY = 'hidden';\r\n\r\n\tmodal\t= document.getElementById('login_modal');\r\n\tmodal.style.display = 'block';\r\n\r\n\t//reset form\r\n\tmodal.querySelectorAll('.authenticator_wrapper:not(.hidden)').forEach(el=>el.classList.add('hidden'));\r\n\tmodal.querySelector('#usercred_wrapper').classList.remove('hidden');\r\n\r\n\tmodal.classList.remove('hidden');\r\n\r\n\twindow.setTimeout(() => modal.querySelector('#username').focus(), 0);\r\n}\r\n\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n\t//check if the current browser supports webauthn\r\n\tcheckWebauthnAvailable();\r\n\r\n\tdocument.querySelectorAll('.login.hidden').forEach(el=>{\r\n\t\tel.classList.remove('hidden');\r\n\t});\t\r\n});\r\n\r\ndocument.addEventListener(\"click\", async function(event){\r\n\tvar target = event.target;\r\n\r\n\tif(target.matches('.login')){\r\n\t\topenLoginModal();\r\n\r\n\t\tconsole.log('Trying silent login');\r\n\t\tlet result\t= await startConditionalRequest('silent');\r\n\r\n\t\t// Show modal with login form\r\n\t\tif(!result){\r\n\t\t\tshowMessage('Automatic passkey login failed, try using your username and password');\r\n\r\n\t\t\topenLoginModal();\r\n\t\t}\r\n\r\n\t}else if(target.id == 'check_cred'){\r\n\t\t// Check if a valid username and password is submitted\r\n\t\tverifyCreds();\r\n\t}else if(target.id == \"login_button\"){\r\n\t\t// Submit the login form when averything is ok\r\n\t\trequestLogin();\r\n\t}else if(target.closest('.toggle_pwd_view') != null){\r\n\t\ttogglePassworView(event);\r\n\t}else if(target.id == 'password-reset-form' || target.id == \"lost_pwd_link\"){\r\n\t\tresetPassword(target.closest('form'));\r\n\t}else if(target.id == 'retry_webauthn'){\r\n\t\tshowMessage('');\r\n\t\tverifyWebauthn([]);\r\n\t}else if(target.name == 'request_account'){\r\n\t\trequestAccount(target);\r\n\t}else if(target.closest(`[name='fingerprintpicture']`) != null){\r\n\t\tstartConditionalRequest('silent');\r\n\t}else if(target.matches('.show-login-qr')){\r\n\t\tshowLoginQrCode();\r\n\t}else if(target.matches('.close-qr')){\r\n\t\thideQrCode();\r\n\t}\r\n});\r\n\r\n//prevent zoom in on login form on a iphone\r\nconst addMaximumScaleToMetaViewport = () => {\r\n\tconst el = document.querySelector('meta[name=viewport]');\r\n  \r\n\tif (el !== null) {\r\n\t  let content = el.getAttribute('content');\r\n\t  let re = /maximum\\-scale=[0-9\\.]+/g;\r\n  \r\n\t  if (re.test(content)) {\r\n\t\t  content = content.replace(re, 'maximum-scale=1.0');\r\n\t  } else {\r\n\t\t  content = [content, 'maximum-scale=1.0'].join(', ')\r\n\t  }\r\n  \r\n\t  el.setAttribute('content', content);\r\n\t}\r\n};\r\n\r\nconst checkIsIOS = () =>/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\r\n\r\nif (checkIsIOS()) {\r\n\taddMaximumScaleToMetaViewport();\r\n}","import { fetchRestApi } from './partials/shared.js';\r\nimport { togglePassworView } from './login.js';\r\n\r\nconsole.log('Password strength.js loaded');\r\n\r\nfunction checkPassStrength() {\r\n\tvar pass1 \t\t= document.querySelector('[name=\"pass1\"]');\r\n\tvar pass2 \t\t= document.querySelector('[name=\"pass2\"]');\r\n\tvar indicator1\t= document.querySelector('#pass-strength-result1');\r\n\tvar indicator2\t= document.querySelector('#pass-strength-result2');\r\n\r\n\tvar pwsL10n = {\r\n\t\tempty: \"Strength indicator\",\r\n\t\tshort: \"Improve this password, maybe add special characters\",\r\n\t\tbad: \"Keep going!\",\r\n\t\tgood: \"Allmost there, make it a little bit stronger\",\r\n\t\tstrong: \"Well done!\",\r\n\t\tmismatch: \"Mismatch\"\r\n\t};\r\n\r\n\tif (pass1.value == '') {\r\n\t\tindicator1.textContent = pwsL10n.empty;\r\n\t\tindicator1.classList.add('hidden');\r\n\t}else{\r\n\t\tupdateIndicator(indicator1);\r\n\t}\r\n\t\r\n\tif (pass2.value == '') {\r\n\t\tindicator2.textContent = pwsL10n.empty;\r\n\t\tindicator2.classList.add('hidden');\r\n\t}else{\r\n\t\tupdateIndicator(indicator2);\r\n\t\t\r\n\t\t//hide password strength indicator1\r\n\t\tif (pass1.value != '') {\r\n\t\t\tindicator1.classList.add('hidden');\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction updateIndicator(indicator){\r\n\tindicator.classList.remove('short', 'bad', 'good', 'strong');\r\n\r\n\tvar pass1 \t\t= document.querySelector('[name=\"pass1\"]');\r\n\tvar pass2 \t\t= document.querySelector('[name=\"pass2\"]');\r\n\r\n\tif(pass1.value != pass2.value){\r\n\t\tindicator.classList.add('bad');\r\n\t\tindicator.textContent = pwsL10n.mismatch;\r\n\t}else{\r\n\t\tvar strength\t= wp.passwordStrength.meter(pass1.value, wp.passwordStrength.userInputDisallowedList(), pass2.value);\r\n\r\n\t\tswitch (strength) {\r\n\t\t\tcase 2:\r\n\t\t\t\tindicator.classList.add('bad');\r\n\t\t\t\tindicator.textContent = pwsL10n.bad;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 3:\r\n\t\t\t\tindicator.classList.add('good');\r\n\t\t\t\tindicator.textContent = pwsL10n.good;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 4:\r\n\t\t\t\tindicator.classList.add('strong');\r\n\t\t\t\tindicator.textContent = pwsL10n.strong;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 5:\r\n\t\t\t\tindicator.classList.add('short');\r\n\t\t\t\tindicator.textContent = pwsL10n.mismatch;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tindicator.classList.add('short');\r\n\t\t\t\tindicator.textContent = pwsL10n['short'];\r\n\t\t}\r\n\t}\r\n\t\r\n\tindicator.classList.remove('hidden');\r\n}\r\n\r\nasync function submitPasswordChange(event){\r\n\tvar form\t= event.target.closest('form');\r\n\r\n\t// show loader\r\n\tform.querySelector('.submit_wrapper .loadergif').classList.remove('hidden');\r\n\r\n\tvar formData\t= new FormData(form);\r\n\r\n\tvar response\t= await fetchRestApi('update_password', formData);\r\n\r\n\tif(response){\r\n\t\tMain.displayMessage(response.message);\r\n\r\n\t\t// redirect to login again if resetting own password\r\n\t\tif(!location.href.includes('?userid=')){\r\n\t\t\tlocation.href\t= response.redirect;\r\n\t\t}\r\n\t}\r\n\r\n\t// hide loader\r\n\tform.querySelector('.submit_wrapper .loadergif').classList.add('hidden');\r\n}\r\n\t\t\t\t\t\r\ndocument.addEventListener(\"DOMContentLoaded\", function() {\r\n\t\r\n\tdocument.querySelectorAll('.changepass').forEach(el=>el.addEventListener(\"keyup\", checkPassStrength));\r\n\r\n\tdocument.querySelectorAll('[name=\"update_password\"]').forEach(el=>el.addEventListener(\"click\",submitPasswordChange));\r\n\r\n\tdocument.querySelectorAll('.toggle_pwd_view').forEach(el=>el.addEventListener(\"click\", togglePassworView));\r\n});"],"names":["__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","closeMobileMenu","document","querySelectorAll","forEach","el","classList","remove","querySelector","ariaExpanded","base64UrlDecode","input","pad","replace","length","Error","Array","join","window","atob","arrayToBase64String","a","btoa","String","fromCharCode","preparePublicKeyOptions","publicKey","challenge","Uint8Array","from","c","charCodeAt","undefined","user","id","excludeCredentials","map","data","allowCredentials","preparePublicKeyCredentials","publicKeyCredential","type","rawId","response","clientDataJSON","attestationObject","authenticatorData","signature","userHandle","showMessage","message","innerHTML","DOMPurify","sanitize","async","requestLogin","add","getElementById","form","formData","FormData","required","reportValidity","Main","waitForInternet","FormSubmit","fetchRestApi","console","log","self","top","parent","textContent","sim","restNonce","nonce","userId","redirect","location","reload","href","intervalId","checkCount","refreshQrCode","wrapper","qrCodeImage","append","dataset","token","wrapperinnerHTML","oldtoken","clearInterval","showLoader","startsWith","login","abortController","credParsing","webauthnSupported","verifyWebauthn","methods","username","result","messageEl","credentials","navigator","JSON","stringify","error","webAuthVerification","showTwoFaFields","PublicKeyCredential","isUserVerifyingPlatformAuthenticatorAvailable","then","modal","startConditionalRequest","mediation","isConditionalMediationAvailable","conditionalMediationSupported","abort","AbortController","onAbort","ev","signal","usercredWrapper","credential","fromCodePoint","processCredential","includes","loadingGif","requestEmailCode","element","setTimeout","focus","disabled","verifyCreds","password","hideModals","find","togglePassworView","target","tagName","parentNode","toggle","title","closest","openLoginModal","style","overflowY","display","checkPassStrength","pass1","pass2","indicator1","indicator2","pwsL10n","updateIndicator","indicator","mismatch","wp","passwordStrength","meter","userInputDisallowedList","bad","good","strong","submitPasswordChange","event","displayMessage","addEventListener","e","contains","available","catch","err","matches","button","loader","resetPassword","name","reset","requestAccount","firstChild","setInterval","test","userAgent","MSStream","content","getAttribute","re","setAttribute","addMaximumScaleToMetaViewport"],"sourceRoot":""}